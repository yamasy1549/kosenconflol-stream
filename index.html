<!doctype html>
<head>
  <meta charset="utf-8">
  <title>chat</title>
</head>
<body>
  <img id="logo" src="./images/logo.png" alt="高専カンファレンスlol">
  <div id="tweets"> </div>
  <div id="bar"><div id="gauge"></div></div>
</body>
<script src="/socket.io/socket.io.js"></script>
<script src="//code.jquery.com/jquery-2.1.3.min.js"></script>
<script>
  var socket = io();
  var colors = ['pink', 'orange', 'yellow', 'green', 'blue'];
  var $tweets = $('#tweets');
  socket.on('msg', function(data) {
    var randTop = Math.floor(Math.random() * 101);
    var randLeft = Math.floor(Math.random() * 101);
    var randColor = Math.floor(Math.random() * 5);
    var $circle = $('<div class="lol-circle"><p>' + data + '</p></div>')
      .addClass(colors[randColor])
      .css({top: randTop + '%', left: randLeft + '%'})
      .delay(10000)
      .queue(function() {
        $(this).remove();
      });
    $tweets.prepend($circle);
  });

  var x = 0;
  var y = 0;
  var z = 0;
  var round_x = 0;
  var round_y = 0;
  var round_z = 0;
  var shakeCount = 0;

  window.addEventListener("devicemotion", function(event) {
    var gauge = document.getElementById("gauge");

    x = event.acceleration.x;
    y = event.acceleration.y;
    z = event.acceleration.z;

    round_x = Math.round(x * 10) / 10;
    round_y = Math.round(y * 10) / 10;
    round_z = Math.round(z * 10) / 10;

    gauge.innerHTML = round_x + "/" + round_y + "/" + round_z;

    if(Math.abs(round_x) > 5 || Math.abs(round_y) > 5 || Math.abs(round_z) > 5) {
      shakeCount++;
      gauge.style.width = shakeCount + '%';
    }
  }, true)
</script>
<link rel="stylesheet" href="styles/style.css">
